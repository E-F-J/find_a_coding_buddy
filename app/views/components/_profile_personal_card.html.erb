
<h1> Dashboard </h1>
<div class="top-container">

  <div class="photo">
    <% if current_user.photo.attached? %>
      <div class="user-photo" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('<%= cl_image_path current_user.photo.key, height: 250, width: 250, crop: :fill %>')">
    <% else %>
      <div class="user-photo" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), image_tag('missing-avatar-female-200x200.png')">
    <% end %>
      </div>
  </div>

  <div class="description">
    <h1><b><%= current_user.first_name  %> <%= current_user.last_name  %></b></h1>
    <h6>Full-Stack developer - Le Wagon</h6>
    <h6><%= current_user.personal_summary%></h6>

    <div class="top-skills d-flex justify-content-between pl-3 pr-3 align-self-end">
      <div>
        <p><b>Top skills:</b> Ruby, Javascript, Python</p>
        <p><b>Experience:</b> Intermediate </p>
      </div>
      <div>
        <i class="fas fa-pencil-alt"></i>
      </div>
    </div>
  </div>

  <div class="your-projects d-flex justify-content-between pl-3 pr-3">
    <div>
      <p> Your Projects:</p>
        <% if current_user.projects.present? %>
          <% current_user.projects.each do |project| %>
            <p> <%= link_to project.title, project_path(project.id) %>
            <% end %>
        <% else %>
          <p>There are no projects to show at present</p>
        <% end %>
    </div>
      <div> <i class="fas fa-pencil-alt"></i> </div>
  </div>
</div>

<div class="bottom-container">
  <div class="background-color">
    <h4>Projects you have applied for:</h4>
      <% current_user.applications.each do |application| %>
        <p> <%= link_to application.project.title, project_path(application.project.id) %>
        with <strong> <%= link_to application.project.user.first_name, user_path(application.project.user.id) %> </strong> </p>
          <% if application.status == nil %>
            <p> <strong> Status: </strong> Pending <i class="fas fa-hourglass-half"></i></p>
          <% elsif application.status == true %>
            <p> <strong> Status: </strong> Congratulations, you've been accepted! <i class="far fa-thumbs-up"></i></p>
          <% else application.status == false %>
            <p> <strong> Status: </strong> Sorry application unsuccesful, try another project! <i class="far fa-thumbs-down"></i></p>
          <% end  %>
      <% end %>
  </div>

  <div class="background-color">
    <div>
      <h4>Applications to your projects:</h4>
      <% @projects.each do |project| %>
        <p> <%= link_to project.title, project_path(project.id) %> </p>
          <% if project.applications.present?%>
            <% project.applications.each do |application|%>
              <% if application.nil?%>
                <p> <%= link_to application.user.first_name, project_path(project.id) %>
                <p class="btn btn-secondary"> <%= link_to "accept", accept_path(id: project.applications.last), method: :post %> </p>
                <p class="btn btn-info"> <%= link_to "reject", reject_path(id: project.applications.last), method: :post %> </p>
              <% else %>
                <p>No new applications</p>
              <% end %>
            <% end %>

            <% else %>
                <p>No new applications</p>
             <% end %>
          <% end %>
    </div>
  </div>
</div>
