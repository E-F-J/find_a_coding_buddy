<div class="container mt-5">
  <%= link_to 'All Code Buddies Projects', projects_path, class: "all-projects-link" %>
  <div class="title-container">
    <h1 class="project-title mt-3"><%= @project.title %></h1>
    <div>
      <% if current_user.id == @project.user.id %>
        <%= link_to "Edit", edit_project_path(@project.id), class: "btn btn-primary edit-project-button" %>
        <%= link_to "Delete", project_path(@project.id),  class:"btn btn-danger", method: :delete, data: {confirm:"Are you sure you want to delete your offered project?"} %>
      <% end %>
    </div>
  </div>
  <% if current_user.id != @project.user.id %>
    <p><i class="fa fa-user"></i> Led by: <%= link_to "#{@project.user.first_name} #{@project.user.last_name}", user_path(@project.user.id) %></p>
  <% end %>
  <h5 class="mt-3 project-main-header">About the Project</h5>
  <div class="row">
    <div class="col-lg-10 col-sm-12">
      <p><%= @project.description %></p>
    </div>
  </div>
  <div class="row mt-3">
    <div class="col-4">
      <h6 class="project-side-header"><i class="fa fa-calendar" aria-hidden="true"></i> Estimated duration:</h6>
      <p><%= @project.duration %> days</p>
    </div>
    <div class="col-4">
      <h6 class="project-side-header"><i class="fas fa-chart-bar"></i> Difficulty level:</h6>
      <p> <%= @project.difficulty.capitalize %> </p>
    </div>
    <div class="col-4">
      <h6 class="project-side-header"><i class="fa fa-link" aria-hidden="true"></i> Project resources:</h6>
        <% if @project.rich_content.body %>
          <p><%= @project.rich_content %></p>
        <% else %>
          <p>None posted so far</p>
        <% end %>
    </div>
  </div>
  <div class="row">
    <div class="col-4">
      <h5 class="mt-4 project-main-header">Technologies involved</h5>
        <%= render 'components/technology_icon' %>
    </div>
    <div class="col-4">
      <h5 class="mt-4 project-main-header">Questions?</h5>
      <%= link_to 'Chat  with the project owner', project_chatroom_path(@project) %> to find out more.
    </div>
  </div>
  <div class="mt-5">
    <% if current_user.id != @project.user.id %>
      <%= link_to "Apply", new_project_application_path(@project.id), class: "btn btn-primary apply-button" %>
    <% end %>
  </div>
  <div class="row mt-5">
    <div class="col">
      <h5 class="related-projects-header">Project reviews</h5>
      <% if @project.reviews.count == 0 %>
        <p>Be the first to
          <%= link_to 'review this project', new_project_review_path(@project) %>
        </p>
      <% else %>
         <% @project_reviews.each do |review| %>
          <%= render 'components/render_reviews' %>
        <% end %>
        <%= link_to 'Leave a review', new_project_review_path(@project) %>
      <% end %>
    </div>
  </div>
  <div class="row mt-5">
    <div class="col">
      <% if @related_projects.count > 0 %>
        <h5 class="related-projects-header">Related projects</h5>
        <% @related_projects.first(3).each do |project| %>
          <%= link_to project_path(project), class: "related-project-title-link" do %>
            <div class="related-project-card mt-3">
              <h3><%= project.title %></h3>
              <p><%= project.description.truncate(100, separator:' ') %></p>
            </div>
          <% end %>
        <% end %>
      <% else %>
        <h5 class="related-projects-header">No related projects found</h5>
      <% end %>
    </div>
  </div>
</div>